name: Merge Feature into Develop

on:
  push:
    branches:
      - 'feature/hu01'

jobs:
  merge-job:
    name: Merge Feature Branch into Develop
    runs-on: ubuntu-latest
    if: ${{ contains(github.event.head_commit.message, 'MergeToDevelop') }}
    steps:
    # Paso 1: Hacer checkout del código
    - name: Checkout Repository
      uses: actions/checkout@v2
      with:
        fetch-depth: 0

    # Paso 2: Configurar Python (si es necesario)
    - name: Setup Python Environment
      uses: actions/setup-python@v2
      with:
        python-version: '3.8'

    # Paso 3: Instalar dependencias (si aplica)
    - name: Install Dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt

    # Paso 4: Validar y realizar el merge
    - name: Merge feature/hu01 into develop
      run: |
        # Configurar Git con el token de GitHub para autenticación
        git config user.name "github-actions[bot]"
        git config user.email "github-actions[bot]@users.noreply.github.com"

        # Validar si la rama develop existe; si no, crearla
        git fetch origin develop || git checkout -b develop

        # Cambiar a la rama develop y realizar el merge
        git checkout develop
        git merge feature/hu01 || echo "Conflicts need manual resolution"

        # Empujar los cambios al remoto
        git push origin develop
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
